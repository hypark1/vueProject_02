{"remainingRequest":"/Users/hypark/project/cdp-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hypark/project/cdp-admin/src/views/contents/Black.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/Users/hypark/project/cdp-admin/src/views/contents/Black.vue","mtime":1581916058163},{"path":"/Users/hypark/project/cdp-admin/node_modules/css-loader/dist/cjs.js","mtime":1573115876168},{"path":"/Users/hypark/project/cdp-admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1573437292219},{"path":"/Users/hypark/project/cdp-admin/node_modules/postcss-loader/src/index.js","mtime":1573115876260},{"path":"/Users/hypark/project/cdp-admin/node_modules/vuetify-loader/lib/loader.js","mtime":1573794163850},{"path":"/Users/hypark/project/cdp-admin/node_modules/cache-loader/dist/cjs.js","mtime":1573115876135},{"path":"/Users/hypark/project/cdp-admin/node_modules/vue-loader/lib/index.js","mtime":1573437292219}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgojYmxhY2tMaXN0IHRhYmxlIHRyIHRkOm50aC1jaGlsZCg1KSB7IHdpZHRoOiA1MDBweDt0ZXh0LWFsaWduOiBsZWZ0ICFpbXBvcnRhbnQ7IH0KI2JsYWNrTGlzdCB0YWJsZSB0ciB0ZDpudGgtY2hpbGQoNSkgcCB7CiAgd2lkdGg6IDEwMCU7CiAgd2hpdGUtc3BhY2U6IG5vcm1hbDsKICBvdmVyZmxvdzogaGlkZGVuOwogIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOwogIGxpbmUtaGVpZ2h0OiAxLjQ7CiAgaGVpZ2h0OiAxLjRlbTsKICB0ZXh0LWFsaWduOiBsZWZ0OwogIHdvcmQtd3JhcDogYnJlYWstd29yZDsKICBkaXNwbGF5OiAtd2Via2l0LWJveDsKICAtd2Via2l0LWxpbmUtY2xhbXA6IDE7CiAgLXdlYmtpdC1ib3gtb3JpZW50OiB2ZXJ0aWNhbDsgfQojYmxhY2tMaXN0IC5saXN0TmV3IHsKICBmb250LXNpemU6IDEwcHg7CiAgcGFkZGluZzogMCA1cHg7CiAgbWFyZ2luLXJpZ2h0OiAzcHggIWltcG9ydGFudDsKfQo="},{"version":3,"sources":["Black.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAucA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Black.vue","sourceRoot":"src/views/contents","sourcesContent":["<template>\n  <v-container\n    id=\"blackList\"\n    fluid\n    tag=\"section\">\n    <v-row\n            align=\"center\"\n            justify=\"center\">\n      <v-col cols=\"12\">\n        <base-material-card\n                color=\"green\">\n          <template v-slot:heading>\n            <h1 class=\"display-2 font-weight-regular\">\n              블랙 리스트\n            </h1>\n          </template>\n          <v-card-text>\n            <!--<v-row justify=\"space-between\" align=\"center\" class=\"ma-0\">\n              <v-row justify=\"start\" class=\"ma-0\">\n                <v-col cols=\"3\">\n                  <v-select\n                          :items=\"config.selectOptions\"\n                          v-model=\"vModel.select\"\n                          label=\"노출\"\n                          color=\"secondary\"\n                          @change=\"submitKeyword\"/>\n                </v-col>\n                <v-col cols=\"4\" style=\"margin-top: 13px;\">\n                  <form @submit.prevent=\"submitKeyword\">\n                    <v-text-field\n                            v-model=\"keyword\"\n                            append-icon=\"mdi-magnify\"\n                            class=\"ml-auto pt-0\"\n                            label=\"Search\"\n                            color=\"secondary\"\n                            hide-details\n                            single-line />\n                  </form>\n                </v-col>\n              </v-row>\n\n              <v-row justify=\"end\" align=\"center\">\n                <v-col cols=\"3\">\n                  <v-menu\n                          ref=\"menu1\"\n                          v-model=\"datePicker.start.menu\"\n                          :close-on-content-click=\"false\"\n                          :return-value.sync=\"datePicker.start.date\"\n                          transition=\"scale-transition\"\n                          min-width=\"290px\"\n                          offset-y >\n                    <template v-slot:activator=\"{ on }\">\n                      <v-text-field\n                              v-model=\"datePicker.start.date\"\n                              color=\"secondary\"\n                              label=\"Start date\"\n                              prepend-icon=\"mdi-calendar-outline\"\n                              readonly\n                              v-on=\"on\" />\n                    </template>\n\n                    <v-date-picker\n                            v-model=\"datePicker.start.date\"\n                            color=\"secondary\"\n                            landscape\n                            scrollable >\n                      <v-spacer />\n                      <v-btn\n                              color=\"secondary\"\n                              @click=\"datePicker.start.menu = false\" >\n                        Cancel\n                      </v-btn>\n\n                      <v-btn\n                              color=\"secondary\"\n                              @click=\"$refs.menu1.save(datePicker.start.date)\" >\n                        OK\n                      </v-btn>\n                    </v-date-picker>\n                  </v-menu>\n                </v-col>\n                <span>-</span>\n                <v-col cols=\"3\">\n                  <v-menu\n                          ref=\"menu2\"\n                          v-model=\"datePicker.end.menu\"\n                          :close-on-content-click=\"false\"\n                          :return-value.sync=\"datePicker.end.date\"\n                          transition=\"scale-transition\"\n                          min-width=\"290px\"\n                          offset-y >\n                    <template v-slot:activator=\"{ on }\">\n                      <v-text-field\n                              v-model=\"datePicker.end.date\"\n                              color=\"secondary\"\n                              label=\"End date\"\n                              prepend-icon=\"mdi-calendar-outline\"\n                              readonly\n                              v-on=\"on\" />\n                    </template>\n\n                    <v-date-picker\n                            v-model=\"datePicker.end.date\"\n                            color=\"secondary\"\n                            landscape\n                            scrollable >\n                      <v-spacer />\n                      <v-btn\n                              color=\"secondary\"\n                              @click=\"datePicker.end.menu = false\" >\n                        Cancel\n                      </v-btn>\n\n                      <v-btn\n                              color=\"secondary\"\n                              @click=\"$refs.menu2.save(datePicker.end.date)\" >\n                        OK\n                      </v-btn>\n                    </v-date-picker>\n                  </v-menu>\n                </v-col>\n                <v-btn\n                        :disabled=\"!vModel.valid\"\n                        color=\"success\"\n                        default\n                        @click=\"submitDate\">\n                  검색\n                </v-btn>\n              </v-row>\n            </v-row>\n              <v-divider class=\"mt-5 mb-5\" />-->\n            <v-row justify=\"space-between\" align=\"center\" class=\"ma-0\">\n              <div>\n                <v-btn\n                        :disabled=\"vModel.contentSelectedBtn[0]\"\n                        class=\"ma-1\"\n                        color=\"warning\"\n                        @click=\"contentExposure(true)\"\n                        small>\n                  ON\n                </v-btn>\n                <v-btn\n                        :disabled=\"vModel.contentSelectedBtn[1]\"\n                        class=\"ma-1\"\n                        color=\"warning\"\n                        @click=\"contentExposure(false)\"\n                        small >\n                  OFF\n                </v-btn>\n              </div>\n            </v-row>\n            <v-divider class=\"mt-3\" />\n            <template v-if=\"resultList\">\n            <v-data-table\n                    v-model=\"contentSelectedData\"\n                    :headers=\"config.headers\"\n                    :items=\"resultList.accusations\"\n                    :items-per-page=\"Number(resultList.meta.perPage)\"\n                    item-key=\"key\"\n                    no-data-text=\"리스트가 없습니다.\"\n                    @click:row=\"tableRowClick\"\n                    hide-default-footer\n                    show-select>\n              <template v-slot:item.message=\"{ item }\">\n                <span class=\"listNew v-btn warning\" v-if=\"listNewBtn(item.date)\">NEW</span>\n                {{ item.message }}\n              </template>\n              <template v-slot:item.isOn=\"{ item }\">\n                <template v-if=\"item.isOn\">ON</template>\n                <template v-else>OFF</template>\n              </template>\n              <template v-slot:item.date=\"{ item }\">\n                {{ item.date.slice(0, 10) }}\n              </template>\n              <template v-slot:item.page=\"{ item }\">\n                <v-btn small>바로가기</v-btn>\n              </template>\n            </v-data-table>\n            <v-pagination\n                    v-model=\"vModel.page\"\n                    :length=\"resultList.meta.lastPage\"\n                    :total-visible=\"10\"\n                    @input=\"paginationClick\"\n                    circle\n                    class=\"justify-center mt-5\"\n                    next-icon=\"mdi-menu-right\"\n                    prev-icon=\"mdi-menu-left\"/>\n          </template>\n          </v-card-text>\n        </base-material-card>\n      </v-col>\n    </v-row>\n  </v-container>\n</template>\n\n<script>\nimport { mapActions } from 'vuex'\n\nexport default {\n  created () {\n    this.reFresh()\n  },\n  data () {\n    return {\n      response: {\n        list: null\n      },\n      keyword: null,\n      contentSelectedData: [],\n      datePicker: {\n        start: {\n          date: '',\n          menu: false\n        },\n        end: {\n          date: '',\n          menu: false\n        }\n      },\n      vModel: {\n        select: 'all',\n        per: 20,\n        page: 1,\n        orderby: 'created',\n        direction: 'desc',\n        where: null,\n        contentSelected: [],\n        contentSelectedIsOn: false,\n        contentSelectedBtn: [ true, true ]\n      },\n      config: {\n        selectOptions: [\n          { value: 'all', text: '전체' },\n          { value: 'on', text: 'ON' },\n          { value: 'off', text: 'OFF' }\n        ],\n        headers: [\n          { text: '상태', value: 'isOn', align: 'center' },\n          { text: '신고일', value: 'date', align: 'center' },\n          { text: '신고 구분', value: 'type', align: 'center' },\n          { text: '상세 내용', value: 'message', align: 'center' },\n          // { text: '본문', value: 'page', align: 'center' }\n        ]\n      }\n    }\n  },\n  methods: {\n    ...mapActions(['xhttp']),\n    snack (type, val) {\n      this.vModel.errorMessage = val\n      this.vModel.snackbarType = type\n      this.vModel.snackbar = true\n    },\n    reFresh () {\n      let send = {\n        page: 1,\n        per: 20,\n      }\n      if (this.$route.query.page) {\n        send.page = this.$route.query.page\n        this.vModel.page = Number(this.$route.query.page)\n      }\n      if (this.$route.query.per) {\n        send.per = this.$route.query.per\n        this.vModel.per = Number(this.$route.query.per)\n      }\n      if (this.$route.query.keyword) {\n        send.keyword = this.$route.query.keyword\n        this.keyword = this.$route.query.keyword\n      }\n      this.$router.replace({ name: 'contentsBlackList', query: send })\n      this.BlackList()\n    },\n    tableRowClick (v) {\n      this.$router.push({ name: 'contentsBlackView', params: { partners_id: v.partner.key, contents_id: v.contents.key } })\n    },\n    paginationClick (page) {\n      this.vModel.page = page\n      let send = {\n        page: page,\n        per: this.vModel.per\n      }\n      if (this.$route.query.keyword) {\n        send.keyword = this.$route.query.keyword\n      }\n      this.$router.replace({ name: 'contentsBlackList', query: send })\n      this.BlackList()\n    },\n    submitKeyword () {\n      let send = {\n        page: 1,\n        per: this.vModel.per\n      }\n      if (this.keyword) {\n        send.keyword = this.keyword\n      }\n      this.$router.push({ name: 'contentsBlackList', query: send })\n      this.vModel.page = 1\n      this.BlackList()\n    },\n    numReplace (val) {\n      let num = val + ''\n      const result = num.replace(/\\D/g, '').replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',')\n\n      return result\n    },\n    submitDate () {\n      //\n    },\n    listNewBtn (val) {\n      let today = this.$moment(new Date()).format('YYYY-MM-DD')\n      return today === val.slice(0, 10)\n    },\n    contentExposure (val) {\n      let text\n      if (val) {\n        // on\n        text = '게재'\n      } else {\n        // off\n        text = '차단'\n      }\n      if (confirm('컨텐츠를 ' + text + ' 하시겠습니까?')) {\n        let data = this.contentSelectedData.map(function ($value) {\n          return $value.contents.key\n        })\n        for (let idx in data) {\n          this.exposure(data[idx], idx)\n        }\n      }\n    },\n    contentSelectedFn (val) {\n      if (val.length === 1 && !this.vModel.contentSelectedIsOn) {\n        // 하나만\n        if (val[0].isOn) {\n          // 첫번째 클릭한게 on\n          this.vModel.contentSelectedBtn = [true, false]\n        } else {\n          // 첫번째 클릭한게 off\n          this.vModel.contentSelectedBtn = [false, true]\n        }\n        this.vModel.contentSelectedIsOn = true\n      } if (val.length === 0) {\n        this.vModel.contentSelectedBtn = [true, true]\n        this.vModel.contentSelectedIsOn = false\n      } else if (val.length > 1) {\n        // 첫번째 클릭한 값\n        let bool = this.vModel.contentSelectedBtn[0]\n        if (bool) {\n          // 첫번째 클릭한 값 on\n          let a = val[val.length - 1].isOn\n          if (!a) {\n            this.contentSelectedData = val.filter(function ($value) {\n              return $value.isOn === true\n            })\n          }\n        } else {\n          // 첫번째 클릭한 값 off\n          let a = val[val.length - 1].isOn\n          if (a) {\n            this.contentSelectedData = val.filter(function ($value) {\n              return $value.isOn === false\n            })\n          }\n        }\n      }\n    },\n    exposure (id, idx) {\n      this.xhttp({\n        url: '/contents/' + id + '/exposure',\n        method: 'put',\n        data: null\n      }).then((response) => {\n        if (response.status === 200) {\n          this.response.exposure = response.data.data\n          let num = this.contentSelectedData[idx].num\n          this.response.list.accusations[num].isOn = this.response.exposure.contents.isOn\n          if (this.contentSelectedData.length - 1 === num) {\n            this.contentSelectedData = []\n            this.response.list = null\n            this.BlackList()\n          }\n        }\n      }).catch((error) => {\n        if (error.message === 'Request failed with status code 401') {\n          this.$router.push({ 'name': 'UserLogin' })\n        } else {\n          this.snack('warning', '관리자에게 문의 바랍니다.')\n        }\n      })\n    },\n    BlackList () {\n      let send = {\n        per: this.$route.query.per,\n        page: this.$route.query.page,\n        orderby: this.vModel.orderby,\n        direction: this.vModel.direction,\n      }\n      if (this.$route.query.keyword) {\n        send.keyword = this.$route.query.keyword\n        send.where = 'title'\n      }\n      this.xhttp({\n        url: '/accusations',\n        method: 'get',\n        params: send\n      }).then((response) => {\n        if (response.status === 200) {\n          this.response.list = response.data.data\n          for (let i = 0; i < this.response.list.accusations.length; i++) {\n            this.response.list.accusations[i].num = i\n          }\n        }\n      }).catch((error) => {\n        if (error.message === 'Request failed with status code 401') {\n          this.$router.push({ 'name': 'UserLogin' })\n        } else {\n          this.snack('warning', '관리자에게 문의 바랍니다.')\n        }\n      })\n    }\n  },\n  computed: {\n    resultList () {\n      if (this.response.list) {\n        return this.response.list\n      } else {\n        return false\n      }\n    }\n  },\n  watch: {\n    keyword: function (val) {\n      if (val === '') {\n        this.submitKeyword()\n      }\n    },\n    contentSelectedData: function (val) {\n      if (val) {\n        this.contentSelectedFn(val)\n      }\n    },\n    datePicker: {\n      handler (val) {\n        if (val.start.date && val.end.date) {\n          this.vModel.valid = true\n        }\n      },\n      deep: true\n    }\n  }\n}\n</script>\n\n<style>\n  #blackList table tr td:nth-child(5) { width: 500px;text-align: left !important; }\n  #blackList table tr td:nth-child(5) p {\n    width: 100%;\n    white-space: normal;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    line-height: 1.4;\n    height: 1.4em;\n    text-align: left;\n    word-wrap: break-word;\n    display: -webkit-box;\n    -webkit-line-clamp: 1;\n    -webkit-box-orient: vertical; }\n  #blackList .listNew {\n    font-size: 10px;\n    padding: 0 5px;\n    margin-right: 3px !important;\n  }\n</style>\n"]}]}